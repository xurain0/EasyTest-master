{% extends "../../base.html" %}

{% block crumbs %}
<div class="row">
    <div class="col-md-12">
        <ol class="breadcrumb">
            <li>
                <a href="/yqjr/index">主页</a>
            </li>
            <li class="active">
                <a class="this">测试数据管理</a>
            </li>
            <li class="active">
                <a class="this-page">资管客户</a>
            </li>
            <li class="active">
                <a class="">添加资管客户数据</a>
            </li>
        </ol>
    </div>
</div>
{% endblock %}

{% block body %}

<div class="row">
    <div class="col-md-12">
        <div class="panel">
            <div class="panel-heading">
                <h3 class="panel-title">添加数据</h3>
            </div>
            <div class="panel-body">
                <form class="form-horizontal" method="post" action="/base/asset_add/">
                    <div class="form-group">
                        <label class="col-sm-2 control-label">测试数据名称</label>
                        <div class="col-sm-8">
                            <input type="text" id="testdataname" name="testdataname" class="form-control">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label">序列号</label>
                        <div class="col-sm-8">
                            <input type="text" id="seqno" name="seqno" placeholder="请输入最大的seqno" style="width:250px" class="form-control">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label">业务流水号</label>
                        <div class="col-sm-8">
                            <input type="text" id="processid" name="processid" placeholder="流水号格式：<发起方编码>-<发起方式>-<业务日期>-<8位流水号>"
                                   class="form-control">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label">流程功能</label>
                        <div class="col-sm-8">
                            <select type="text" id="processtype" name="processtype" required="required"
                                    class="form-control" style="width:250px">
                                <option value='1' selected="selected">申请交易编码</option>
                                <option value='2'>撤销交易编码</option>
                                <option value='3'>修改身份信息</option>
                                <option value='4'>修改一般信息</option>
                                <option value='5'>交易所开户报备</option>
                                <option value='6'>交易所销户报备</option>
                                <option value='7'>补报规范资料</option>
                                <option value='8'>账户休眠</option>
                                <option value='9'>激活休眠账户</option>
                                <option value='10'>解除开仓限制</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label">资管客户</label>
                        <div class="col-sm-2 control-label">
                            <label class="fancy-radio">
                                <input name="method" value="assetindividual" checked="checked"  onclick="change(this)"
                                       id="assetindividual" type="radio"><span><i></i>资管个人</span>
                            </label>
                        </div>
                        <div class="col-sm-2 control-label">
                            <label class="fancy-radio">
                                <input name="method" value="assetorgan" id="assetorgan"  onclick="change(this)"
                                       type="radio"><span><i></i>资管单位</span>
                            </label>
                        </div>
                        <div class="col-sm-2 control-label">
                            <label class="fancy-radio">
                                <input name="method" value="assetspecialorgan" id="assetspecialorgan"  onclick="change(this)"
                                       type="radio"><span><i></i>资管特殊单位</span>
                            </label>
                        </div>
                        <div class="col-sm-2 control-label">
                            <label class="fancy-radio">
                                <input name="method" value="assetonemore" id="assetonemore"  onclick="change(this)"
                                       type="radio"><span><i></i>资管一对多</span>
                            </label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label">开户客户地域</label>
                        <div class="col-sm-8">
                            <select type="text" id="clientregion" name="clientregion" required="required"
                                    class="form-control" style="width:250px" onchange="setSel(this);" >
                                <option value='1' selected="selected">境内客户</option>
                                <option value='4'>永久居留的境外客户</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label">期货市场客户编码</label>
                        <div class="col-sm-8">
                            <input type="text" id="futuresid" name="futuresid" value=""
                                   class="form-control" style="width:250px">
                            只有修改客户资料或者加开交易所帐户时，输入客户编码
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label">交易所编号</label>
                        <div class="col-sm-8">
                            <select class="form-control"  type="text" id="exchangeid" name="exchangeid"
                                    required="required" style="width:250px">
                                <option value='S' selected="selected">上海期货交易所</option>
                                <option value='N'>上海国际能源交易中心</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label">期货公司编码</label>
                        <div class="col-sm-8">
                            <input type="text" id="companyid" name="companyid" required="required"
                                   class="form-control" style="width:250px">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label">交易类型</label>
                        <div class="col-sm-8">
                            <select type="text" id="exclientidtype" name="exclientidtype" required="required"
                                    class="form-control" style="width:250px">
                                <option value='1'>套保</option>
                                <option value='2'>套利</option>
                                <option value='3' selected="selected">投机</option>
                                <option value='4'>做市商</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label">客户名称</label>
                        <div class="col-sm-8">
                            <input type="text" id="clientname" name="clientname" required="required"
                                   class="form-control" style="width:250px">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label">证件号码</label>
                        <div class="col-sm-8">
                            <input type="text" id="idoriginal" name="idoriginal" required="required"
                                   class="form-control" style="width:250px">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label">银行账号</label>
                        <div class="col-sm-8">
                            <input type="text" id="accountno" name="accountno"
                                   class="form-control" style="width:250px" required="required">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label">开户行网点</label>
                        <div class="col-sm-8">
                            <input type="text" id="branchname" name="branchname" value=""
                                   class="form-control" style="width:250px" required="required">
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-sm-offset-4 col-sm-6">
                            <button type="submit" id="sumbit" class="btn btn-primary">保存</button>
                            <button type="button" class="btn btn-primary" onclick="javascript:history.back(-1);">返回</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

{% endblock %}
{% block javascript %}
<script>

    function del_step(obj) {
        var tr = obj.parentNode.parentNode;
        var tbody = tr.parentNode;
        tbody.removeChild(tr);
    }

    $('#sumbit').click(function () {

        var if_name = $("#if_name").val();
        var prj_id = $("#prj_id").val();
        var url = $("#url").val();
        var method = $("input[name='method']:checked").val();
        var data_type = $("#data_type").val();
        {#var is_sign = $("input[name='is_sign']:checked").val();#}
        var description = $("textarea[name='description']").val();

        var request_header_data;
        var request_body_data;
        var response_header_data;
        var response_body_data;

        var args = [];
        $('#request_header tr').each(function (i) {
            if (i == 0) return true;
            var data = new Object();
            $(this).find("td[name]").each(function () {
                var name = $(this).attr("name");
                data[name] = $(this).text();
            });
            args.push(data);
        });
        request_header_data = JSON.stringify(args);

        var args = [];
        $('#request_body tr').each(function (i) {
            if (i == 0) return true;
            var data = new Object();
            $(this).find("td[name]").each(function () {
                var name = $(this).attr("name");
                data[name] = $(this).text();
            });
            args.push(data);
        });
        request_body_data = JSON.stringify(args);

        var args = [];
        $('#request_header tr').each(function (i) {                   // 遍历 tr
            if (i == 0) return true;
            var data = new Object();
            $(this).find("td[name]").each(function () {
                var name = $(this).attr("name");
                data[name] = $(this).text();
            });
            args.push(data);
        });
        response_header_data = JSON.stringify(args);

        var args = [];
        $('#request_header tr').each(function (i) {                   // 遍历 tr
            if (i == 0) return true;
            var data = new Object();
            $(this).find("td[name]").each(function () {
                var name = $(this).attr("name");
                data[name] = $(this).text();
            });
            args.push(data);
        });
        response_body_data = JSON.stringify(args);

        $.ajax({
            url: "/base/interface_add/",
            type: "post",
            data: {
                "if_name": if_name,
                "prj_id": prj_id,
                "url": url,
                "method": method,
                "data_type": data_type,
                {#"is_sign": is_sign,#}
                "description": description,
                "request_header_data": request_header_data,
                "request_body_data": request_body_data,
                "response_header_data": response_header_data,
                "response_body_data": response_body_data,
            },
            // dataType: "json",

            success: function () {
                alert("保存成功");
                window.location.replace("/base/data/");
            },
            error: function () {
                alert("error!");
            }
        });

    });
    function change(arg) {
                var rd = arg;
                var thisdiv = document.getElementById(rd.id + "_div");
                var divs = document.getElementById('rd_div').getElementsByTagName('div');
                for (var i = 0; i < divs.length; i++) {
                    if (divs[i].id == thisdiv.id) {
                        divs[i].style.display = '';
                        alert('nihao1')
                    }
                    else {
                        divs[i].style.display = 'none';
                        alert('nihao2')
                    }
                    var chbs = divs[i].getElementsByTagName('input');
                    var checkedstr = "";
                    for (var j = 0; j < chbs.length; j++) {
                        if (chbs[j].checked) {
                            checkedstr += chbs[j].value + ',';
                        }
                    }
                    var txt = document.getElementById(divs[i].id.substring(0, 3) + "_txt");
                    txt.value = checkedstr;
                }
                var thistxt = document.getElementById(rd.id + "_txt");
                var txts = document.getElementsByName('txt_rd');
                for (var i = 0; i < txts.length; i++) {
                    if (txts[i].id == thistxt.id) txts[i].style.display = '';
                    alert('nihao3')
                    else txts[i].style.display = 'none';
                    alert('nihao4')
                }
            }
</script>
{% endblock %}